<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contagem de Produtos</title>
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <style>
    :root {
      --bg-color: #f9fafc;
      --card-bg: #ffffff;
      --text-color: #333;
      --accent: #1e88e5;
      --muted: #6c757d;
      --border: #ccc;
    }

    [data-theme="dark"] {
      --bg-color: #121212;
      --card-bg: #1f1f1f;
      --text-color: #e0e0e0;
      --accent: #90caf9;
      --muted: #aaaaaa;
      --border: #333;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    h1 {
      text-align: center;
      color: var(--accent);
      margin-bottom: 30px;
    }

    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--card-bg);
      border: 1px solid var(--border);
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      z-index: 999;
    }

    .form-card {
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 25px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      border: 1px solid var(--border);
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-weight: 600;
    }

    input, select, textarea {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid var(--border);
      font-size: 15px;
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    textarea { resize: vertical; }

    .vencimento-card {
      background: var(--card-bg);
      padding: 15px;
      border-left: 4px solid var(--accent);
      border-radius: 8px;
      margin-bottom: 15px;
      border: 1px solid var(--border);
    }

    .add-button {
      background-color: #43a047;
      color: white;
      border: none;
      padding: 12px 16px;
      font-size: 15px;
      border-radius: 30px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary, .btn-copy {
      width: 100%;
      background-color: var(--accent);
      color: white;
      border: none;
      padding: 14px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
    }

    .btn-copy {
      background-color: var(--muted);
    }

    .mensagem {
      background: var(--card-bg);
      border-left: 5px solid var(--accent);
      margin-top: 25px;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid var(--border);
      white-space: pre-wrap;
      font-family: monospace;
    }

    .divider {
      border-top: 2px dashed var(--border);
      margin: 30px 0;
    }

    lottie-player {
      width: 36px;
      height: 36px;
      vertical-align: middle;
      margin-right: 10px;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      font-size: 18px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">üåì</button>

  <h1>üìã Contagem de Produtos</h1>

  <div class="form-card">
    <div class="section-header">
      <lottie-player src="https://assets10.lottiefiles.com/packages/lf20_qp1q7mct.json" background="transparent" speed="1" loop autoplay></lottie-player>
      Produto
    </div>
    <div class="form-group">
      <input type="text" id="produto" placeholder="Ex: Iogurte Natural 170g">
    </div>

    <div class="section-header">
      <lottie-player src="https://assets5.lottiefiles.com/packages/lf20_UJNc2t.json" background="transparent" speed="1" loop autoplay></lottie-player>
      Loja
    </div>
    <div class="form-group">
      <input type="text" id="loja" placeholder="Ex: Loja Centro">
    </div>
  </div>

  <div class="form-card" id="vencimentos"></div>

  <button class="add-button" onclick="adicionarVencimento()">‚ûï Adicionar outra contagem</button>

  <div class="divider"></div>

  <div class="form-card">
    <div class="section-header">
      <lottie-player src="https://assets1.lottiefiles.com/packages/lf20_ztf2f1be.json" background="transparent" speed="1" loop autoplay></lottie-player>
      Observa√ß√µes
    </div>
    <div class="form-group">
      <textarea id="obs" rows="3" placeholder="Ex: Produto na geladeira da frente"></textarea>
    </div>
  </div>

  <button class="btn-primary" onclick="gerarMensagem()">üìÑ Gerar Mensagem</button>
  <div class="mensagem" id="mensagem"></div>
  <button class="btn-copy" onclick="copiarMensagem()">üìã Copiar Mensagem</button>

  <script>
    function aplicarMascaraData(input) {
      input.addEventListener("input", () => {
        let valor = input.value.replace(/\D/g, "");
        if (valor.length > 8) valor = valor.slice(0, 8);
        if (valor.length > 4) {
          input.value = valor.replace(/(\d{2})(\d{2})(\d{1,4})/, "$1/$2/$3");
        } else if (valor.length > 2) {
          input.value = valor.replace(/(\d{2})(\d{1,2})/, "$1/$2");
        } else {
          input.value = valor;
        }
      });
    }

    function adicionarVencimento() {
      const container = document.getElementById('vencimentos');
      const grupo = document.createElement('div');
      grupo.className = 'vencimento-card';
      grupo.innerHTML = `
        <label>üì¶ Quantidade</label>
        <input type="number" placeholder="Ex: 10" />

        <label>üìÖ Data de vencimento</label>
        <input type="text" class="data" placeholder="dd/mm/aaaa" />

        <label>üìç Localiza√ß√£o</label>
        <select>
          <option value="√Årea de vendas">√Årea de vendas</option>
          <option value="Estoque">Estoque</option>
        </select>
      `;
      container.appendChild(grupo);
      aplicarMascaraData(grupo.querySelector('.data'));
    }

    function gerarMensagem() {
      const produto = document.getElementById('produto').value.trim();
      const loja = document.getElementById('loja').value.trim();
      const obs = document.getElementById('obs').value.trim();
      const grupos = document.querySelectorAll('.vencimento-card');

      if (!produto || !loja || grupos.length === 0) {
        alert('Preencha produto, loja e ao menos uma contagem.');
        return;
      }

      let mensagem = `üì¶ Produto: ${produto}\nüè¨ Loja: ${loja}\n\nüìÜ Contagens:\n`;

      grupos.forEach(grupo => {
        const inputs = grupo.querySelectorAll('input, select');
        const qtd = inputs[0].value;
        const vencimento = inputs[1].value;
        const local = inputs[2].value;
        if (qtd && vencimento && local) {
          mensagem += `‚Ä¢ ${qtd} unidades (${local}) - ${vencimento}\n`;
        }
      });

      if (obs) mensagem += `\nüìù Obs: ${obs}`;
      document.getElementById('mensagem').textContent = mensagem;
    }

    function copiarMensagem() {
      const texto = document.getElementById('mensagem').textContent;
      if (!texto) return alert('Gere a mensagem primeiro.');
      navigator.clipboard.writeText(texto).then(() => {
        alert('‚úÖ Mensagem copiada com sucesso!');
      });
    }

    function toggleTheme() {
      const html = document.documentElement;
      const atual = html.getAttribute('data-theme');
      html.setAttribute('data-theme', atual === 'dark' ? 'light' : 'dark');
    }

    // Aplica tema baseado no sistema
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.documentElement.setAttribute('data-theme', 'dark');
    } else {
      document.documentElement.setAttribute('data-theme', 'light');
    }

    adicionarVencimento();
  </script>
</body>
</html>
